# Ход прохождения code review проекта


## 2022-03-05 01:30MSK - code-review, наставник: [Александр Чепайкин](https://ru.hexlet.io/u/alexgreendev)
Приветствую :) Что ж давайте порефакторим!

Бэйджик codeclimate должен быть от вашего репозитория. Сейчас он у вас о трепозитория codeclimate

В пятом шаге в задачах упониманалось, что не нужно использовать то что вы создали в cli.py для других игр. https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/script_helper.py#L1

DESCRIPTION было бы более подходящим названием переменной https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L5

Это лучше внести в функцию в качестве локальной переменной. https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L7

Лучше не сокращать слова без необходимости. https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L15

В последнем шаге есть ссылка на статью про именования в программировании. Обязательно прочитайте и пройдитесь по всему проекту. Например все функции должны быть глаголами и вот эту я бы назвать get_question_and_answer https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L14

В python в таких случаях приянто принебрегать скобками для tuple т.е. можно писать просто

return question, correct_answer
https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L25

Удалите пожалуйста все комментарии которые не несут полезной нагрузки https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/gcd.py#L7

Лучше сделать два парамметра у функции. Так все будет выглядеть гораздо проще и читаемее. К тому что у вас нет случая когда вы будете передавать другое колличество чисел. Или используйте функцию gcd из стандартной библиотеки. (from math import gcd) https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/gcd.py#L24

модули gconf.py и script_helper.py избыточны. Игры не должны быть связаны общими настройками. Это слишком сильная связь и ее причина не очевидна. В каждой игре вполне нормально использовать разные диапозоны для генерации случайных чисел и т.д.

## 2022-03-05 12:05MSK - уточнения у Наставника Hexlet по code-review от 2022-03-04-

Добрый день, Александр!

> Приветствую :) Что ж давайте порефакторим!
Рад Вашему выздоровлению!

Александр, поясните, пожалуйста, при сдаче проектов я обязан непосредственно и строго выполнять сразу Ваши требования о рефакторинге и расценивать пожелания как непосредственный приказ?

Или обсуждение - возможно? На случай, если возможно,- привожу пояснения и запросы о дополнительных разъяснениях.

Также считаю необходимым сообщить Вам, что с целью раскрытия логики внесения исправления в проект, 
в том числе для неоднозначных требований проверяющей стороны (например, по субъективному мнению не согласуются с требованиями технического задания),
которые вынужденно будут реализованы (для сдачи проекта),-
результаты рассмотрения проекта с Вашей стороны и пояснения с моей стороны
потенциально могут быть приложены в репозитории проекта
для дальнейшего пояснения с моей стороны при последующих code review проекта с иными лицами.

=====================================================================================================
>Бэйджик codeclimate должен быть от вашего репозитория. Сейчас он у вас о трепозитория codeclimate

Изменения внесены, прошу проверить.

=====================================================================================================
> В пятом шаге в задачах упониманалось, что не нужно использовать то что вы создали в cli.py для других игр. 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/script_helper.py#L1

> модули gconf.py и script_helper.py избыточны. Игры не должны быть связаны общими настройками. 
> Это слишком сильная связь и ее причина не очевидна. В каждой игре вполне нормально использовать
> разные диапозоны для генерации случайных чисел и т.д.

Прошу Вас пояснить, что конкретно Вы подразумеваеет под "упониманалось, что не нужно использовать то что вы создали".

Привожу свои пояснения:
Само требование 5го шага (иных на данном шаге к файлу cli.py - нет):
"Файлы, которые мы добавили ранее (brain_games/cli.py, brain_games/scripts/brain_games.py), оставьте, как есть, и не смешивайте с остальным кодом. cli.py не предназначен для описания логики игр."

При этом есть вот такое требование шага 3:
"Опишите эту логику в функции welcome_user файла brain_games/cli.py и поместите вызов этой функции в скрипт brain_games/scripts/brain_games.py."

Таким образом, я предполагаю, что 
1) в cli должны быть реализованы необходимое играм взаимодействие с пользователем,
при этом игровой логики (выяснение является ли это число четным, какого правильное значение НОД,...)
быть не должно,-  и это реализовано и было реализовано в проекте;

2) сами игры (точнее, скрипты вариантов запусков игр) могут и обязаны минимум настраивать функции интерфейса взаимодействия с пользователем (см. "поместите вызов этой функции в скрипт"),-  и это реализовано и было реализовано в проекте.

При этом обратите внимание на требование из шага 6:
"С введением второй игры у вас появляется общая для всех игр логика. Главная задача этого шага – построить архитектуру запуска игр так, чтобы эта логика была в одном месте и управляла играми."

При этом для всех игр есть обязательное требование (которое может изменяться - потенциально)
из шага 6:
"Максимальное количество раундов одинаково для всех игр и должно быть равно трём."

При этом - согласно 5ому шагу (см. требование выше) - я должен оставить scripts/brain_games.py фактически бесполезной пустышкой.
Но при этом - согласно сильному требованию шага 5 - "Don’t repeat yourself".


Таким образом, требование наличия глобальной настройки внесено именно формулировкой задания игры
("...одинаково для всех игр..."), но понимаем, что ничего глобального по возможности быть не должно (в том числе для этапа тестирования, которое пока формально студентом не изучалось),
и эти глобальные параметры в текущей реализации передаем в игру в качестве параметра функции -
и ничто не помешает в текущей реализации при необходимости для каждой отдельной игры на практике использовать
свои диапазоны случайных чисел. Но наличие одинаковых преднастроек - удобно и _необходимо_ согласно
формулировке самого задания игры (тех.задания). 
И именно поэтому был заведен модуль gconf.py.
(От использования которого, тем не менее, при оконечной реализации можно и отказаться - при необходимости. Сохранив при этом необходимый интерфейс. Но использование классов в реализации запрещено тех.заданием, словари студент формально еще не проходил на момент реализации проекта.)

Таким образом, использование модуля gconf.py, на мой взгляд, в проекте полностью оправдано.

Александр, Вы настаиваете на удалении модуля gconf.py? 
В таком случае прошу Вас привести пример реализации (в общих словах, принципиально) глобальных настроек для всех игр (наличие необходимо согласно формулировке задания) по количеству раундов и т.д. (При этом необходимо учитывать ограничения последовательности обучения: формально - файловый ввод-вывод на данном этапе студент еще не изучал, файлов конфигураций .conf, .ini - пока как будто не существует.)


Касательно модуля "script_helper.py" - его наличие позволяет выполнить требование 
шага 5 "Don’t repeat yourself" и
абстрагироваться уже во всех проверочных скриптах игр (типа brain_gcd, brain_prime..) от непосредственной настройки интерфейса взаимодействия с пользователем (это сейчас cli; а потом может быть gui, tui; а еще весьма вероятно появление требования локализации),
подключения глобальных настроек _всех игр_ (которые требуются согласно ТЗ),
при этом наглядно демонстрируется "пустышка" текущей реализации (согласно требованиям ТЗ) brain_games.py,
но закладывается база для дальнейшего логичного расширения функционала,- 
например, запуска нескольких игр из brain_games (почему-то же оно названо "games"? однако кто-то пока не выставил шаг 10?). 
Заказчик ведь не хочет править - при изменении реализации интерфейса пользователя с cli на tui -
править копипастой все скрипты проверки игр? 
(Тем более, что скрипты проверки можно свести к ссылкам на brain_games, непосредственно в котором и анализировать "а какую конкретно игру запустил пользователь" - или показать общее меню (если запуск всё-таки обобщенного brain_games.)
И даже само наличие скриптов проверки - уже избыточная бездумная копипаста.))

Александр, Вы настаиваете на удалении модуля script_helper.py? 
В таком случае прошу Вас привести пример реализации (в общих словах) требуемого ТЗ варианта, но с выполнением Ваших условий, но также - с недопущением нарушения принципа "Don’t repeat yourself".


=====================================================================================================
> DESCRIPTION было бы более подходящим названием переменной 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L5

Александр, 

договоримся о тезаурусе:
[BANNER](https://wooordhunt.ru/word/banner) - флаговый заголовок; газетный заголовок во всю ширину полосы; 
[DESCRIPTION](https://wooordhunt.ru/word/description) - описание.

Приведем полную цитату (не форме анекдота, как в подготовительном курсе) соответствующее ситуации высказывание:
"There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors.",-
используемый в дальнейшем перевод:
«В компьютерных науках есть только две сложные проблемы – аннулирование кэша, придумывание названий и ошибка на единицу»,— Леон Бамбрик (см. https://habr.com/ru/company/productivity_inside/blog/493288/).

В данных константах - BANNER - (в разных модулях) фактически в соответствии с ТЗ содержится не описание игр(ы) (которое можно было бы в дальнейшем привести в help-е, например),
а именно непосредственно шапка, сообщение, приветствие (потенциально - часть приветствия),
которое выводится перед началом игры. При этом практически никакого описания правил игры не приводится (в соответсвии с ТЗ).

Пояснения: наименования констант, переменных в проекте - мною продумавались.
Но прошу учесть мнение г-на Бамбрика.

Считаю наименование констант BANNER - подходящим, отражающим суть содержащейся в них информации.
(Честно говоря, на мой взгляд - странно, что проектом не требуется наличия комментариев в коде,
отражающих суть реализации, и описания модулей, функций.
Но раз ТЗ не требует - считаем, что пока от студента это и не требуется.)

Александр, Вы настаиваете на изменении наименования данных констант?


=====================================================================================================
> Это лучше внести в функцию в качестве локальной переменной. 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L7

Пояснение: 
а) в модуле задана константа уровня видимости модуля
OPS = [  dict(func=op.add, str="+"), ... ] ;
б) модуль - calc.py, т.е. вычисления;
в) наличие константы уровня видимости модуля в модуле позволяет визуально сразу определить поддерживаемые 
модулем игры арифметические операции;
г) наличие константы уровня видимости модуля в модуле позволяет достаточно просто реализовать в дальнейшем тестирование (с подстановкой в OPS - последовательно mock-объекты проверяемых реализаций функций);
д) OPS - это не переменная по сути, это - по задумке - именно константа;
е) на мой взгляд, при дальнейшем расширении модуля вероятность использования данной константы в иных функциях модуля достаточно высока (например, при реализации калькулятора выражений в обратной польской записи).

Александр, Вы настаиваете на переносе данной константы в область видимости конкретной фукнции?


=====================================================================================================
> Лучше не сокращать слова без необходимости. 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L15

Александр, совершенно с Вами согласен, слова без необходимости лучше не сокращать.

Как и не удлиннять при необходимости,- позвольте сослаться 
на PEP8 (чтобы было - т.к. расходжений мною с требованиями - не выявлено)
и на статью
[Длинные имена слишком длинные](https://habr.com/ru/post/450986/) от автора Bob Nystrom,
"То, о чем я хожу поговорить, — это то, что я вижу во многих кодах, и что сводит меня с ума: излишне длинные имена.",
"
Выбор хорошего имени
У любого имени в программировании имеется две цели:
- Имя должно быть ясным: нужно знать к чему оно относится.
- Имя должно быть точным: нужно знать к чему оно не относится.
"

Сокращение операции до op при наличии весьма небольшой (8 значимых строк в теле) функции в модуле calc.py
позволяет охватить взглядом логику полностью, с учетом наименования модуля (calc) 
уловить логику контекста наименования.
В то же время, например, раскрытие сокращения
```
op_index = randint(0, len(OPS) - 1)
```
с учетом того, что operation тоже не очень (допустим) раскрывает логику переменной,
выразилось бы в
```
index_of_supported_math_operation = get_random_integer_number_within_interval(0, length_of(SUPPORTED_MATH_OPERATIONS) - 1)
```
, что, собственно, читабельности, на мой субъективный взгляд (допускаю, что и по мнению Bob Nystrom), 
тоже не добавляет.

Александр, Вы настаиваете на раскрытии сокращений в данном случае?

Как бы Вы рекомендовали назвать в случае требования раскрытия сокращений 
(с учетом постуалата "There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors."):
0) сам модуль calc (название модуля диктуется требованиями ТЗ);
1) round (с учетом того, что это - функция, и "должна" начинаться с "глагола");
2) randint (с учетом того, что это стандартная функция, но её наименование не согласуется в требованием о глаголе);
3) arg0, arg1 (с учетом мнения потенциальных иностранных работодателей и, в частности, Bob Nystrom, о неприемлемости наименований типа mathematical_operation_left_argument;
4) value - значение выполнения математической операции;
5) иные переменные?



=====================================================================================================
> В последнем шаге есть ссылка на статью про именования в программировании. 
> Обязательно прочитайте и пройдитесь по всему проекту. 
> Например все функции должны быть глаголами и вот эту я бы назвать 
> get_question_and_answer 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L14

Повторно приведем полную цитату (не форме анекдота, как в подготовительном курсе) соответствующее ситуации высказывание:
"There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors.",-
используемый в дальнейшем перевод:
«В компьютерных науках есть только две сложные проблемы – аннулирование кэша, придумывание названий и ошибка на единицу»,— Леон Бамбрик (см. https://habr.com/ru/company/productivity_inside/blog/493288/).

Александр,
> Например все функции должны быть глаголами
насколько я понял - в python отстутствует такое требование (см., например, pep8); 
более того, стандартные встроенные функции python (https://docs.python.org/3/library/functions.html) 
не подчиняются данному требованию в подавляющем большинстве, см., например, len, next, map, pow.

> и вот эту я бы назвал get_question_and_answer 

- и это бы не отражало сути функции, реализующей фактически отдельный раунд игры.
Смотрите, предлагаемое Вами наименование уже вводит в заблуждение - исходя из названия
get_question_and_answer - я вижу, что функция вернет вопрос и  ответ на вопрос, да?
Т.е. провзаимодействует с пользователем и вернет его ответ на поставленный вопрос,
т.е. еще и вопрос пользователю отобразит, я верно читаю наименование функции?

Александр, наименования переменных, констант, вспомогательных (не требуемых напрямую ТЗ) модулей
я производил в соответствии с рекомендациями к наименованию переменных в программировании.

Александр, если существует для данного проекта какое-то утвержденное соглашение о наименовании, 
о форматировании и т.д. - приведите его, пожалуйста (чтобы как-будто в жизни Вы меня на code-review отсылали rtfm).

И у меня взгляд - замылен, если всё-таки требуется изменения наименований - 
Александр, можете, пожалуйста, привести подробный перечень требуемых к изменению наименований (желательно - с рекомендуемыми именованиями).



=====================================================================================================
> В python в таких случаях приянто принебрегать скобками для tuple т.е. можно писать просто
> return question, correct_answer
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/calc.py#L25

Александр, насколько я понимаю,
в частности, из статьи https://stackoverflow.com/questions/354883/best-way-to-return-multiple-values-from-a-function
```
def f(x):
  y0 = x + 1
  y1 = x * 3
  y2 = y0 ** y3
  return (y0, y1, y2)
```
, пренебрежениями скобками при возврате кортежа - не является общеупотребительной рекомендуемой практикой python,
и пренебрежение скобками - имеет предпосылки к ухудшению читаемости кода.

Александр, Вы настаиваете на удалении скобок при возврате значений кортежей в коде Проекта?
Возможно, есть какой-то PEP, или для проекта целиком - оформленные конкретные по отношению к возврату кортежей требования к оформлению кода, и Вы сможете представить их на ознакомление?

=====================================================================================================
> Удалите пожалуйста все комментарии которые не несут полезной нагрузки 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/gcd.py#L7

Александр, в модуле изначально были оставлены комментарии следующих категорий:
1) комментарии, которые пойдут в основу проверки правильности реализации не совсем простой функции gcd 
при дальнейшем тестировании (вернее, при добавлении этого фукнционала к проекту,- 
на текущий момент студенты формально с автоматизированным тестированием в python еще не знакомы);
2) комментарии, которые ссылаются на алгоритмы деталей реализации математической функции gcd;
3) комментарии, которые приводят описание функции, описание ожидаемого поведения (то, что пойдет 
в дальнейшем в документирование функции, наряду с пунктом (2); 
на текущий момент студенты формально не знакомы с концепцией docstrings python-а
и необходимостью покрытия документацией функций, модулей,...).

Таким образом, на мой взгляд, все оставленные комментарии несут полезную нагрузку.

Александр, какие именно комментарии Вы требуете удалить?
И, возможно, как Вы потом рекомендуете удаленные комментарии восстанавливать - при дальнейшей реализации
pytest / dostrings ?

=====================================================================================================
> Лучше сделать два парамметра у функции. Так все будет выглядеть гораздо проще и читаемее. 
> К тому что у вас нет случая когда вы будете передавать другое колличество чисел. 
> Или используйте функцию gcd из стандартной библиотеки. 
> (from math import gcd) 
> https://github.com/taa2021/python-project-lvl1/blob/main/brain_games/games/gcd.py#L24

Александр, Ваши рекомендации, к сожалению, расходятся с требованиями ТЗ.

Согласно требованиям шага 7 "Игра НОД" настоятельно рекомендуется
использовать подсказку (из тела задачи)
"
Подсказки
Зависит ли реализация функции нахождения НОД от того, как использует ее вызывающий код?
"

Реализации функции возможны - собственная (как приведено в проекте), стандартная (на которую ссылаетесь Вы,
и документация к которой размещена по адресу https://docs.python.org/3/library/math.html).

Согласно рекомендации из подсказки реализации должны быть совместимы (т.е. использование данные функции 
"сторонним" кодом не должно зависеть от реализации),
т.е. ожидается, что сигнатура функции должна быть одинакова, для одного набора аргументов - должны возвращаться
одинаковые значения.

Согласно приведенной ссылке, в документации к стандартной функции gcd сказано, что
"
Changed in version 3.9: Added support for an arbitrary number of arguments. Formerly, only two arguments were supported.
"
функция (т.е. и собственной реализации) должна поддерживать произвольное количество аргументов.
Более того, у библиотечной функции достаточно нетривиальные варианты возврата для отдельных случаев 
("If any of the arguments is nonzero, then the returned value is the largest positive integer that is a divisor of all arguments. If all arguments are zero, then the returned value is 0. gcd() without arguments returns 0.")

ТЗ не говорит прямо о возможности использования при реализации проекта стандартной функции,
но вот согласно ответа техподдержки hexlet от 08.01.2021 (Сергей)
настоятельно рекомендуется использовать собственную реализацию:
"
Сергей К.Поддержка
08 января 2021
Задача состоит в том, чтобы выделить операцию поиска НОД в отдельную функцию. Но использовать библиотечную функцию также не воспрещается. Хотя для того, чтобы прокачать работу с алгоритмами, полезно реализовать эту функцию самостоятельно.
"

Таким образом, предлагаемая в проекте реализация функции gcd - собственная, совместимая со стандартной библиотечной функцией из модуля math,- является правильным решением поставленной задачи согласно ТЗ
и рекомендаций площадки hexlet (ТП).
И частная рекомендация "лучше сделать два параметра у функции", к сожалению, не позволяет реализовать указанных требований.

Александр, Вы настаиваете на удалении кода собственной реализации функции gcd и использовании стандартной функции модуля math?

=====================================================================================================

Александр, благодарю Вас за code-review проекта!

Правки по всем однозначным требованиям - выполнены, прошу Вас проверить.
По неоднозначным моментам - задал Вам вопросы и очень ожидаю Вашего развернутого ответа.
